#!/system/bin/sh
# Adaptive Performance - Remove App Governor (API Version)

API_PORT=9877
PKG="$1"

[ -z "$PKG" ] && {
    echo "‚ùå Usage: adaptperf-delappgov <package>"
    echo "Example: adaptperf-delappgov com.proxima.dfm"
    exit 1
}

echo "üóëÔ∏è  Removing custom governor for: $PKG"
echo ""

# Call API endpoint (sama dengan dashboard)
RESPONSE=$(echo "" | nc 127.0.0.1 $API_PORT << EOF
GET /?action=remove_app_governor&pkg=$PKG HTTP/1.1
Host: 127.0.0.1
Connection: close

EOF
)

# Parse response
if echo "$RESPONSE" | grep -q '"status":"success"'; then
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë  ‚úÖ SUCCESS                                       ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "‚úì Custom governor removed: $PKG"
    echo "‚úì Config reset to default"
    echo ""
    echo "üí° Check log: cat /data/local/tmp/adaptive_perf.log"
else
    echo "‚ùå Failed to remove app governor"
    echo ""
    echo "Response:"
    echo "$RESPONSE" | grep -o '{.*}'
fi
